연동 방식과 포함 범위를 안정성 기준으로 재정리했습니다.

추천 구조

백엔드 2개 프로세스, 1개 UI
Scanner: /health, /v1/search/{local,server}, /v1/tasks/{bootstrap,update}.
Downloader: CLI ingest 전용(권장). API가 필요하면 /health만 최소로 두고, 나중에 잡 API 추가 여부 결정.
UI(웹): 검색 → JSON export → “CLI ingest 가이드”만 표시. Downloader API가 없으니 브라우저에서 직접 다운로드 지시는 안 함.
대안 1: 웹에 모두 포함(단일 백엔드)

하나의 백엔드가 Scanner와 Downloader 기능 모두 HTTP API로 노출.
UI는 검색 결과 선택 후 /downloader/jobs에 POST로 다운로드 트리거 → 상태 폴링.
장점: 브라우저에서 끝까지 처리. 단점: 다운로드 경로/권한 문제(서버 측에만 파일 저장), XP 경로 길이 제약 관리 필요, 구현/운영 복잡도 증가.
지금 요구 “꼭 필요 아님”이므로 당장은 미적용을 권장.
대안 2: 현행 분리 + UI 최소 연동(권장)

UI는 Scanner API만 사용(프록시 /scanner).
선택 결과를 JSON으로 내보내고 “CLI로 d5 ingest 실행” 안내.
다운로드 경로/길이/권한은 CLI가 책임져서 안정적.
대안 3: UI 내에서 Downloader 호출하되, 서버 측 실행

UI가 /downloader/ingest 같은 엔드포인트를 호출하면, 백엔드가 서버 로컬 경로(dest_root)로 저장.
클라이언트 PC에 저장되지는 않음(서버 스토리지 필요). 보안/권한/경로 길이 검증 필수.
연동 절차(권장안 기준)

Scanner 부트스트랩/업데이트 후 /v1/search/{local,server} 제공.
UI에서 검색 → 다중 선택 → JSON export.
사용자가 서버 또는 로컬에서 CLI d5.7.8 ingest --file exported.json --dest-root D:\DATA --overwrite resume 실행.
보고서(out/downloader/reports)로 결과 확인.
UI 수정 포인트

Downloader jobs 버튼/탭 제거 또는 비활성.
검색 결과에 recipe 다중일 때 “two+” 배지/툴팁.
툴팁/푸터에 CLI ingest 사용법 명시.
권장 방향

지금은 “Scanner API + UI 검색 + CLI ingest”로 단순/안정 운영.
추후 필요 시: 서버 저장용 Downloader API 추가(대안 3), 그 다음에야 완전 통합 백엔드(대안 1) 검토.